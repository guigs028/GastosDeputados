// Schema para aplicação de transparência dos gastos dos deputados
// Baseado na API da Câmara dos Deputados

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Tabela de Deputados
model Deputado {
  id                Int      @id @default(autoincrement())
  
  // Dados básicos
  idCamara          Int      @unique             // ID da API da Câmara
  nome              String                       // Nome completo
  partido           String                       // Sigla do partido (PT, PSDB...)
  uf                String                       // Estado (SP, RJ, MG...)
  email             String?                      // Email (opcional)
  urlFoto           String?                      // URL da foto (opcional)
  
  // Para controle
  ativo             Boolean  @default(true)      // Se ainda está ativo
  criadoEm          DateTime @default(now())     // Quando foi criado
  atualizadoEm      DateTime @updatedAt          // Última atualização
  
  // Relacionamento: 1 deputado tem várias despesas
  despesas          Despesa[]
  
  @@map("deputados")
}

// Tabela de Despesas
model Despesa {
  id                Int      @id @default(autoincrement())
  
  // Dados principais
  ano               Int                          // Ano da despesa (2024)
  mes               Int                          // Mês (1-12)
  valor             Float                        // Valor em reais
  tipoDespesa       String                       // Tipo: "COMBUSTÍVEL", "ALIMENTAÇÃO"...
  fornecedor        String                       // Nome do fornecedor
  dataDocumento     DateTime                     // Data do documento
  
  // Dados do documento (opcional)
  numeroDocumento   String?                      // Número da nota fiscal
  urlDocumento      String?                      // Link para o documento
  
  // Relacionamento: cada despesa pertence a 1 deputado
  deputado          Deputado @relation(fields: [deputadoId], references: [id])
  deputadoId        Int                          // ID do deputado
  
  // Para controle
  criadoEm          DateTime @default(now())     // Quando foi criado
  atualizadoEm      DateTime @updatedAt          // Última atualização
  
  @@map("despesas")
  @@index([ano, mes])                            // Índice para buscar por período
  @@index([deputadoId])                          // Índice para buscar por deputado
  @@index([tipoDespesa])                         // Índice para buscar por tipo
}
